# üîÆ –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ compositionsDAG.json](#—à–∞–≥-1-–ø–æ–ª—É—á–µ–Ω–∏–µ-compositionsdagjson)
3. [–®–∞–≥ 2: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ NetworkX DiGraph](#—à–∞–≥-2-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ-–≤-networkx-digraph)
4. [–®–∞–≥ 3: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—É—Ç–µ–π –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö](#—à–∞–≥-3-–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ-–ø—É—Ç–µ–π-–∏-—Å–æ–∑–¥–∞–Ω–∏–µ-–æ–±—É—á–∞—é—â–∏—Ö-–¥–∞–Ω–Ω—ã—Ö)
5. [–®–∞–≥ 4: –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∑–ª–æ–≤ (LabelEncoder)](#—à–∞–≥-4-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ-—É–∑–ª–æ–≤-labelencoder)
6. [–®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ PyTorch Geometric –¥–∞–Ω–Ω—ã—Ö](#—à–∞–≥-5-—Å–æ–∑–¥–∞–Ω–∏–µ-pytorch-geometric-–¥–∞–Ω–Ω—ã—Ö)
7. [–®–∞–≥ 6: –û–±—É—á–µ–Ω–∏–µ DAGNN –º–æ–¥–µ–ª–∏](#—à–∞–≥-6-–æ–±—É—á–µ–Ω–∏–µ-dagnn-–º–æ–¥–µ–ª–∏)
8. [–®–∞–≥ 7: Inference (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ)](#—à–∞–≥-7-inference-–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ)

---

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —Å–µ—Ä–≤–∏—Å/—Ç–∞–±–ª–∏—Ü—É –≤ workflow –Ω–∞ –æ—Å–Ω–æ–≤–µ:
- –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–∑–∏—Ü–∏–π –∏–∑ –ë–î
- DAG —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∞—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π –≥—Ä–∞—Ñ)
- Graph Neural Network (DAGNN)

**–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è:** 2-5 –º–∏–Ω—É—Ç
**–í—Ä–µ–º—è inference:** 10-50ms

### ‚ö†Ô∏è –í–∞–∂–Ω–æ! –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–≤—è–∑–µ–π –≤ DAG

–í —Å–∏—Å—Ç–µ–º–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏–π —Å—É—â–µ—Å—Ç–≤—É—é—Ç **—Ç–æ–ª—å–∫–æ –¥–≤–∞ —Ç–∏–ø–∞ —Å–≤—è–∑–µ–π**:

```
‚úÖ Table ‚Üí Service
   –¢–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–∞–∫ –≤—Ö–æ–¥–Ω–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–µ—Ä–≤–∏—Å—É
   –ü—Ä–∏–º–µ—Ä: table_1001 ‚Üí service_123 (–ø–∞—Ä–∞–º–µ—Ç—Ä "theme")

‚úÖ Service ‚Üí Service
   –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –¥—Ä—É–≥–æ–º—É —Å–µ—Ä–≤–∏—Å—É
   –ü—Ä–∏–º–µ—Ä: service_123 ‚Üí service_456 (–ø–∞—Ä–∞–º–µ—Ç—Ä "file")

‚ùå Service ‚Üí Table –ù–ï –°–£–©–ï–°–¢–í–£–ï–¢!
   –¢–∞–±–ª–∏—Ü—ã –ù–ï –º–æ–≥—É—Ç –±—ã—Ç—å —Ü–µ–ª—å—é —Å–≤—è–∑–∏
   –¢–∞–±–ª–∏—Ü—ã - —Ç–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
```

**–¢–∏–ø–∏—á–Ω—ã–π workflow:**
```
table_A ‚Üí service_1 ‚Üí service_2
table_B ‚Üí service_2 ‚Üí service_3

–≥–¥–µ:
- table_A, table_B - –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- service_1, service_2, service_3 - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã
- service_1 ‚Üí service_2 - –ø–µ—Ä–µ–¥–∞—á–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```

---

## –®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ compositionsDAG.json

### 1.1 –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ recover_new()

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  await recover_new(db)                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ Calls –∏–∑ –ë–î                   ‚îÇ
‚îÇ     SELECT * FROM Calls ORDER BY id ASC         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  2. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—ã/–≤—ã—Ö–æ–¥—ã –∫–∞–∂–¥–æ–≥–æ –≤—ã–∑–æ–≤–∞     ‚îÇ
‚îÇ     - call.input  (–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)                   ‚îÇ
‚îÇ     - call.result (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  3. –ù–∞—Ö–æ–¥–∏—Ç —Å–≤—è–∑–∏ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª—ã –∏ –¥–∞—Ç–∞—Å–µ—Ç—ã        ‚îÇ
‚îÇ     - WIDGET_FILE: —Ñ–∞–π–ª–æ–≤—ã–µ —Å–≤—è–∑–∏               ‚îÇ
‚îÇ     - WIDGET_THEME_SELECT: –¥–∞—Ç–∞—Å–µ—Ç—ã             ‚îÇ
‚îÇ     - WIDGET_EDIT: –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  4. –°—Ç—Ä–æ–∏—Ç –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ (workflows)               ‚îÇ
‚îÇ     Composition = {                             ‚îÇ
‚îÇ       "nodes": [service1, table1, service2],    ‚îÇ
‚îÇ       "links": [                                ‚îÇ
‚îÇ         {source: 0, target: 1},                 ‚îÇ
‚îÇ         {source: 1, target: 2}                  ‚îÇ
‚îÇ       ]                                         ‚îÇ
‚îÇ     }                                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ
              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  5. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ app/static/compositionsDAG.json ‚îÇ
‚îÇ     [                                           ‚îÇ
‚îÇ       {nodes: [...], links: [...]},             ‚îÇ
‚îÇ       {nodes: [...], links: [...]},             ‚îÇ
‚îÇ       ...                                       ‚îÇ
‚îÇ     ]                                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 1.2 –ü—Ä–∏–º–µ—Ä compositionsDAG.json

```json
[
  {
    "nodes": [
      {"id": "1002132", "mid": null},      // table_1002132
      {"id": 3985, "mid": 308},            // service_308
      {"id": 3986, "mid": 309}             // service_309
    ],
    "links": [
      {"source": "1002132", "target": 3985, "fields": "1002132:theme"},  // table ‚Üí service (input)
      {"source": 3985, "target": 3986, "fields": ["file:source"]}        // service ‚Üí service (result)
    ]
  },
  ...
]
```

**–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:**
- `mid` != null - —ç—Ç–æ —Å–µ—Ä–≤–∏—Å ‚Üí –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ `service_{mid}`
- `mid` == null - —ç—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ ‚Üí –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ `table_{id}`

**–í–∞–∂–Ω–æ! –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–≤—è–∑–µ–π:**
- ‚úÖ **Table ‚Üí Service** - —Ç–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–∞–∫ –≤—Ö–æ–¥–Ω–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–µ—Ä–≤–∏—Å—É
- ‚úÖ **Service ‚Üí Service** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –¥—Ä—É–≥–æ–º—É
- ‚ùå **Service ‚Üí Table** - –¢–ê–ö–û–ì–û –ù–ï –ë–´–í–ê–ï–¢! (—Ç–∞–±–ª–∏—Ü—ã –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Ü–µ–ª—å—é, —Ç–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º)

---

## –®–∞–≥ 2: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ NetworkX DiGraph

### 2.1 –ó–∞—á–µ–º –Ω—É–∂–µ–Ω NetworkX DiGraph?

```
compositionsDAG.json                NetworkX DiGraph
(—Å–ø–∏—Å–æ–∫ –∫–æ–º–ø–æ–∑–∏—Ü–∏–π)        ‚Üí        (–µ–¥–∏–Ω—ã–π –≥—Ä–∞—Ñ —Å–æ –≤—Å–µ–º–∏ —Å–≤—è–∑—è–º–∏)

[                                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  {nodes: [...], links: [...]},     ‚îÇ   service_123        ‚îÇ
  {nodes: [...], links: [...]},  ‚Üí  ‚îÇ        ‚Üì             ‚îÇ
  ...                                ‚îÇ   table_1002120      ‚îÇ
]                                    ‚îÇ        ‚Üì             ‚îÇ
                                     ‚îÇ   service_456        ‚îÇ
–ü—Ä–æ–±–ª–µ–º—ã:                            ‚îÇ        ‚Üì             ‚îÇ
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∑–ª–æ–≤                 ‚îÇ   table_1001211      ‚îÇ
- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥—Ä–∞—Ñ—ã                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
- –ù–µ—Ç –µ–¥–∏–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã               
                                     –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
                                     - –ï–¥–∏–Ω—ã–π –≥—Ä–∞—Ñ
                                     - –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
                                     - –ê–ª–≥–æ—Ä–∏—Ç–º—ã –ø–æ–∏—Å–∫–∞ –ø—É—Ç–µ–π
                                     - –ê–Ω–∞–ª–∏–∑ —Å–≤—è–∑–Ω–æ—Å—Ç–∏
```

### 2.2 –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

```python
def _load_dag_from_json(self, json_path: Path) -> nx.DiGraph:
    # –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç–æ–π –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –≥—Ä–∞—Ñ
    dag = nx.DiGraph()
    
    # –®–∞–≥ 2: –î–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
    for composition in data:
        # –®–∞–≥ 2.1: –ú–∞–ø–ø–∏–Ω–≥ –ª–æ–∫–∞–ª—å–Ω—ã—Ö ID ‚Üí –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞
        id_to_mid = {}
        for node in composition["nodes"]:
            if "mid" in node:
                # –≠—Ç–æ —Å–µ—Ä–≤–∏—Å
                id_to_mid[node["id"]] = f"service_{node['mid']}"
            else:
                # –≠—Ç–æ —Ç–∞–±–ª–∏—Ü–∞
                id_to_mid[node["id"]] = f"table_{node['id']}"
        
        # –®–∞–≥ 2.2: –î–æ–±–∞–≤–∏—Ç—å —Ä—ë–±—Ä–∞
        for link in composition["links"]:
            src = id_to_mid[link["source"]]  # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π ID
            tgt = id_to_mid[link["target"]]  # –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –∏–º—è
            
            # –î–æ–±–∞–≤–∏—Ç—å —É–∑–ª—ã —Å —Ç–∏–ø–æ–º
            dag.add_node(src, type='service' if 'service' in src else 'table')
            dag.add_node(tgt, type='service' if 'service' in tgt else 'table')
            
            # –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–±—Ä–æ
            dag.add_edge(src, tgt)
    
    return dag
```

### 2.3 –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

```
–ö–æ–º–ø–æ–∑–∏—Ü–∏—è 1:                         –ö–æ–º–ø–æ–∑–∏—Ü–∏—è 2:
node_1 (id=1001) ‚Üí node_2 (mid=123)   node_a (id=1002) ‚Üí node_b (mid=123)
                                      
–ü–æ—Å–ª–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ ID:                 –ü–æ—Å–ª–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ ID:
table_1001 ‚Üí service_123              table_1002 ‚Üí service_123

                    ‚Üì –û–ë–™–ï–î–ò–ù–ï–ù–ò–ï ‚Üì

           –ï–¥–∏–Ω—ã–π NetworkX DiGraph:
           
         table_1001    table_1002
                  ‚îÇ        ‚îÇ
                  ‚ñº        ‚ñº
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ   service_123       ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         
NetworkX –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —É–∑–ª—ã (service_123 –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ä—ë–±—Ä–∞
- –°–æ–∑–¥–∞—ë—Ç –µ–¥–∏–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≥—Ä–∞—Ñ–∞
```

### 2.4 –†–µ–∑—É–ª—å—Ç–∞—Ç

```python
dag.nodes()  # ['service_123', 'table_1001', 'table_1002', 'service_456', ...]
dag.edges()  # [('table_1001', 'service_123'), ('table_1002', 'service_123'), ('service_123', 'service_456'), ...]

# –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
# table ‚Üí service  (—Ç–∞–±–ª–∏—Ü–∞ –∫–∞–∫ –≤—Ö–æ–¥)
# service ‚Üí service (—Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –¥–∞–ª—å—à–µ)

# –ú–æ–∂–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å:
dag.in_degree('table_1001')   # –°–∫–æ–ª—å–∫–æ –≤—Ö–æ–¥—è—â–∏—Ö —Å–≤—è–∑–µ–π
dag.out_degree('service_123')  # –°–∫–æ–ª—å–∫–æ –∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–≤—è–∑–µ–π
dag.successors('table_1001')  # –°–ª–µ–¥—É—é—â–∏–µ —É–∑–ª—ã
nx.has_path(dag, 'table_1001', 'table_1002')  # –ï—Å—Ç—å –ª–∏ –ø—É—Ç—å
```

---

## –®–∞–≥ 3: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—É—Ç–µ–π –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### 3.1 –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—É—Ç–µ–π –∏–∑ DAG

```
–î–∞–Ω–æ: DAG –≥—Ä–∞—Ñ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  A ‚Üí B ‚Üí C ‚Üí D                  ‚îÇ
‚îÇ  A ‚Üí E ‚Üí F                      ‚îÇ
‚îÇ  B ‚Üí G                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–¶–µ–ª—å: –ò–∑–≤–ª–µ—á—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—É—Ç–∏

–ê–ª–≥–æ—Ä–∏—Ç–º:
for each node in dag:
    if node.out_degree > 0:
        DFS –æ—Ç —ç—Ç–æ–≥–æ —É–∑–ª–∞
        
–†–µ–∑—É–ª—å—Ç–∞—Ç - –ø—É—Ç–∏:
[
    [A, B, C, D],    # –ü—É—Ç—å 1
    [A, B, G],       # –ü—É—Ç—å 2
    [A, E, F],       # –ü—É—Ç—å 3
    [B, C, D],       # –ü—É—Ç—å 4
    [B, G],          # –ü—É—Ç—å 5
    [E, F]           # –ü—É—Ç—å 6
]
```

### 3.2 –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—É—á–∞—é—â–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤

```
–ò–∑ –ø—É—Ç–µ–π —Å–æ–∑–¥–∞—ë–º –ø–∞—Ä—ã (–∫–æ–Ω—Ç–µ–∫—Å—Ç ‚Üí —Å–ª–µ–¥—É—é—â–∏–π —É–∑–µ–ª)

–ü—É—Ç—å: [table_1001, service_123, table_1002, service_456]

–û–±—É—á–∞—é—â–∏–µ –ø—Ä–∏–º–µ—Ä—ã:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ö–æ–Ω—Ç–µ–∫—Å—Ç              ‚Üí  –°–ª–µ–¥—É—é—â–∏–π —É–∑–µ–ª         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ (table_1001,)         ‚Üí  service_123            ‚îÇ
‚îÇ (table_1001,          ‚Üí  table_1002             ‚îÇ
‚îÇ  service_123)                                   ‚îÇ
‚îÇ (table_1001,          ‚Üí  service_456            ‚îÇ
‚îÇ  service_123,                                   ‚îÇ
‚îÇ  table_1002)                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–§–∏–ª—å—Ç—Ä: –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–ª–µ–¥—É—é—â–∏–π —É–∑–µ–ª = service_*
(–º—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å—ã, —Ç–∞–±–ª–∏—Ü—ã —è–≤–ª—è—é—Ç—Å—è –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏)

–ò—Ç–æ–≥–æ:
X_raw = [
    (table_1001,),               # –ö–æ–Ω—Ç–µ–∫—Å—Ç: –Ω–∞—á–∞–ª–∏ —Å —Ç–∞–±–ª–∏—Ü—ã
    (table_1001, service_123),   # –ö–æ–Ω—Ç–µ–∫—Å—Ç: —Ç–∞–±–ª–∏—Ü–∞ + —Å–µ—Ä–≤–∏—Å
]
y_raw = [
    service_123,  # –ü–æ—Å–ª–µ table_1001 –∏—Å–ø–æ–ª—å–∑—É—é—Ç service_123
    service_456   # –ü–æ—Å–ª–µ (table_1001, service_123) —Å–ª–µ–¥—É–µ—Ç service_456
]

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º workflow:**
- table_1001 ‚Üí service_123 (—Ç–∞–±–ª–∏—Ü–∞ –∫–∞–∫ –≤—Ö–æ–¥ –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞)
- service_123 ‚Üí service_456 (—Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–µ—Ä–≤–∏—Å–∞ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –¥–∞–ª—å—à–µ)
- table_1002 ‚Üí service_456 (–¥—Ä—É–≥–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ç–æ–∂–µ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è service_456)

**–í–∞–∂–Ω–æ:** –í y_raw –º—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ:
  - –°–µ—Ä–≤–∏—Å—ã - —ç—Ç–æ —Ç–æ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç/–∑–∞–ø—É—Å–∫–∞–µ—Ç
  - –¢–∞–±–ª–∏—Ü—ã - —ç—Ç–æ –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –æ–Ω–∏ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å "—Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º"
  - –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏: "–ü–æ—Å–ª–µ service_123, –∫–∞–∫–æ–π —Å–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–ª—å—à–µ?"
```

### 3.3 –ö–æ–¥

```python
def _create_training_data(self, paths: List[List[str]]) -> Tuple[List, List]:
    X_raw = []  # –ö–æ–Ω—Ç–µ–∫—Å—Ç—ã
    y_raw = []  # –¶–µ–ª–µ–≤—ã–µ —É–∑–ª—ã
    
    for path in paths:
        # –î–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –≤ –ø—É—Ç–∏ (–∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–π –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π)
        for i in range(1, len(path) - 1):
            context = tuple(path[:i])      # –í—Å—ë –¥–æ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏
            next_step = path[i]            # –¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è
            
            # –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–ª–µ–¥—É—é—â–∏–π —É–∑–µ–ª - —Å–µ—Ä–≤–∏—Å
            if next_step.startswith("service"):
                X_raw.append(context)
                y_raw.append(next_step)
    
    return X_raw, y_raw
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
X_raw: [(service_123,), (service_123, table_1001), ...]
y_raw: [service_456, table_1002, ...]
```

---

## –®–∞–≥ 4: –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∑–ª–æ–≤ (LabelEncoder)

### 4.1 –ó–∞—á–µ–º –Ω—É–∂–µ–Ω LabelEncoder?

```
–ü—Ä–æ–±–ª–µ–º–∞: Neural Networks —Ä–∞–±–æ—Ç–∞—é—Ç —Å —á–∏—Å–ª–∞–º–∏, –Ω–µ —Å—Ç—Ä–æ–∫–∞–º–∏

–°—Ç—Ä–æ–∫–æ–≤—ã–µ –∏–º–µ–Ω–∞ —É–∑–ª–æ–≤:              –ß–∏—Å–ª–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ service_123        ‚îÇ   ‚Üí  fit()  ‚îÇ      0       ‚îÇ
‚îÇ table_1001         ‚îÇ   ‚Üí         ‚îÇ      1       ‚îÇ
‚îÇ service_456        ‚îÇ   ‚Üí         ‚îÇ      2       ‚îÇ
‚îÇ table_1002         ‚îÇ   ‚Üí         ‚îÇ      3       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

LabelEncoder —Å–æ–∑–¥–∞—ë—Ç –±–∏–µ–∫—Ç–∏–≤–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
  string ‚Üê‚Üí integer
```

### 4.2 –ü—Ä–æ—Ü–µ—Å—Å fit_transform

```python
# –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
node_list = ['service_123', 'table_1001', 'service_456', 'table_1002']

# –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å encoder
node_encoder = LabelEncoder()

# –®–∞–≥ 2: fit_transform
node_ids = node_encoder.fit_transform(node_list)

# –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏:
# fit():
#   - –ù–∞—Ö–æ–¥–∏—Ç –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: {'service_123', 'table_1001', ...}
#   - –°–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏—Ö (–∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ)
#   - –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –∏–Ω–¥–µ–∫—Å—ã: 0, 1, 2, 3, ...
#   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–∞–ø–ø–∏–Ω–≥ –≤–Ω—É—Ç—Ä–∏

# transform():
#   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∏—â–µ—Ç –µ–≥–æ –∏–Ω–¥–µ–∫—Å
#   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –∏–Ω–¥–µ–∫—Å–æ–≤

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
node_ids = [0, 1, 2, 3]  # numpy array
```

### 4.3 –°–æ–∑–¥–∞–Ω–∏–µ node_map

```python
# –°–æ–∑–¥–∞—ë–º —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
node_map = {node: idx for node, idx in zip(node_list, node_ids)}

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
node_map = {
    'service_123': 0,
    'table_1001': 1,
    'service_456': 2,
    'table_1002': 3
}

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
idx = node_map['service_123']  # ‚Üí 0
idx = node_map['table_1001']   # ‚Üí 1
```

### 4.4 –í–∏–∑—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 LabelEncoder Process                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Input (—Å—Ç—Ä–æ–∫–∏):
  ['service_123', 'table_1001', 'service_456', 'table_1002']
           ‚îÇ
           ‚ñº
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇ  LabelEncoder   ‚îÇ
  ‚îÇ                 ‚îÇ
  ‚îÇ  fit():         ‚îÇ
  ‚îÇ   1. Unique     ‚îÇ
  ‚îÇ   2. Sort       ‚îÇ
  ‚îÇ   3. Assign IDs ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
Output (—á–∏—Å–ª–∞):
  [0, 1, 2, 3]
  
Mapping (—Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ encoder):
  service_123 ‚Üî 0
  table_1001  ‚Üî 1
  service_456 ‚Üî 2
  table_1002  ‚Üî 3

–û–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (inverse_transform):
  [0, 1, 2, 3] ‚Üí ['service_123', 'table_1001', ...]
```

---

## –®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ PyTorch Geometric –¥–∞–Ω–Ω—ã—Ö

### 5.1 –ß—Ç–æ —Ç–∞–∫–æ–µ PyTorch Geometric Data?

```
PyTorch Geometric - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è Graph Neural Networks

Data –æ–±—ä–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  data.x          # Node features    ‚îÇ
‚îÇ  data.edge_index # Graph structure  ‚îÇ
‚îÇ  data.y          # Labels (–æ–ø—Ü.)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 5.2 –°–æ–∑–¥–∞–Ω–∏–µ node features (data.x)

```python
# –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞ —Å–æ–∑–¥–∞—ë–º –≤–µ–∫—Ç–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
features = []
for node in node_list:
    if dag.nodes[node]['type'] == 'service':
        features.append([1, 0])  # One-hot: [is_service, is_table]
    else:
        features.append([0, 1])  # One-hot: [is_service, is_table]

# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Ç–µ–Ω–∑–æ—Ä
x = torch.tensor(features, dtype=torch.float)
```

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
```
–£–∑–µ–ª             Type      Feature Vector
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
service_123   ‚Üí service ‚Üí [1, 0]
table_1001    ‚Üí table   ‚Üí [0, 1]
service_456   ‚Üí service ‚Üí [1, 0]
table_1002    ‚Üí table   ‚Üí [0, 1]

–ò—Ç–æ–≥–æ–≤—ã–π —Ç–µ–Ω–∑–æ—Ä x:
tensor([[1, 0],    ‚Üê service_123 (–∏–Ω–¥–µ–∫—Å 0)
        [0, 1],    ‚Üê table_1001  (–∏–Ω–¥–µ–∫—Å 1)
        [1, 0],    ‚Üê service_456 (–∏–Ω–¥–µ–∫—Å 2)
        [0, 1]])   ‚Üê table_1002  (–∏–Ω–¥–µ–∫—Å 3)

Shape: (4, 2)  # 4 —É–∑–ª–∞, 2 –ø—Ä–∏–∑–Ω–∞–∫–∞ –∫–∞–∂–¥—ã–π
```

### 5.3 –°–æ–∑–¥–∞–Ω–∏–µ edge_index (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥—Ä–∞—Ñ–∞)

```python
# –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–±—Ä–∞ –≤ DAG
edge_list = []
for u, v in dag.edges():
    src_idx = node_map[u]  # –ò–Ω–¥–µ–∫—Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞
    tgt_idx = node_map[v]  # –ò–Ω–¥–µ–∫—Å —Ü–µ–ª–∏
    edge_list.append([src_idx, tgt_idx])

# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Ç–µ–Ω–∑–æ—Ä –∏ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä—É–µ–º
edge_index = torch.tensor(edge_list, dtype=torch.long).t()
```

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
```
DAG edges (—Å—Ç—Ä–æ–∫–æ–≤—ã–µ) - –ü–†–ê–í–ò–õ–¨–ù–´–ï –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
  table_1001  ‚Üí service_123  ‚úÖ (—Ç–∞–±–ª–∏—Ü–∞ –∫–∞–∫ –≤—Ö–æ–¥ –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞)
  service_123 ‚Üí service_456  ‚úÖ (—Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–µ—Ä–≤–∏—Å–∞ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –¥—Ä—É–≥–æ–º—É)
  table_1002  ‚Üí service_456  ‚úÖ (–≤—Ç–æ—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∫–∞–∫ –≤—Ö–æ–¥)

–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ node_map:
  service_123: 0
  table_1001:  1
  service_456: 2
  table_1002:  3

–†—ë–±—Ä–∞ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏:
  1 ‚Üí 0    (table_1001 ‚Üí service_123)
  0 ‚Üí 2    (service_123 ‚Üí service_456)
  3 ‚Üí 2    (table_1002 ‚Üí service_456)

edge_list:
  [[1, 0],
   [0, 2],
   [3, 2]]

edge_index (—Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π):
  tensor([[1, 0, 3],    ‚Üê Source nodes
          [0, 2, 2]])   ‚Üê Target nodes

Shape: (2, 3)  # 2 —Ä—è–¥–∞ (src, tgt), 3 —Ä–µ–±—Ä–∞

–ü–æ—á–µ–º—É —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω?
PyTorch Geometric —Ç—Ä–µ–±—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç [2, num_edges]:
  - –†—è–¥ 0: –∏–Ω–¥–µ–∫—Å—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
  - –†—è–¥ 1: –∏–Ω–¥–µ–∫—Å—ã —Ü–µ–ª–µ–π
```

### 5.4 –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ –∏ —Ü–µ–ª–µ–π –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

```python
# –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º X_raw –∏ y_raw –≤ –∏–Ω–¥–µ–∫—Å—ã

X_raw = [
    (service_123,),
    (service_123, table_1001),
]

y_raw = [
    service_456,
    table_1002
]

# –ò—Å–ø–æ–ª—å–∑—É–µ–º node_map –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
contexts = torch.tensor([
    node_map[context[-1]]  # –ë–µ—Ä—ë–º –ü–û–°–õ–ï–î–ù–ò–ô —ç–ª–µ–º–µ–Ω—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
    for context in X_raw
], dtype=torch.long)

targets = torch.tensor([
    node_map[y]
    for y in y_raw
], dtype=torch.long)
```

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
```
X_raw (–∫–æ–Ω—Ç–µ–∫—Å—Ç—ã):                contexts (–∏–Ω–¥–µ–∫—Å—ã):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ (table_1001,)        ‚îÇ  ‚Üí       ‚îÇ  1   ‚îÇ  (–ø–æ—Å–ª–µ–¥–Ω–∏–π = table_1001)
‚îÇ (table_1001,         ‚îÇ  ‚Üí       ‚îÇ  0   ‚îÇ  (–ø–æ—Å–ª–µ–¥–Ω–∏–π = service_123)
‚îÇ  service_123)        ‚îÇ          ‚îÇ      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

y_raw (—Ü–µ–ª–∏):                     targets (–∏–Ω–¥–µ–∫—Å—ã):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ service_123          ‚îÇ  ‚Üí       ‚îÇ  0   ‚îÇ
‚îÇ table_1002           ‚îÇ  ‚Üí       ‚îÇ  3   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

contexts: tensor([1, 0])  # –ò–Ω–¥–µ–∫—Å—ã –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —É–∑–ª–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö
targets:  tensor([0, 3])  # –ò–Ω–¥–µ–∫—Å—ã —Ü–µ–ª–µ–≤—ã—Ö —É–∑–ª–æ–≤
```

### 5.5 –ò—Ç–æ–≥–æ–≤—ã–π Data –æ–±—ä–µ–∫—Ç

```python
from torch_geometric.data import Data

data_pyg = Data(
    x=x,              # Node features: (num_nodes, num_features)
    edge_index=edge_index  # Graph structure: (2, num_edges)
)

# –ü—Ä–∏–º–µ—Ä:
data_pyg.x.shape         # torch.Size([4, 2])  - 4 —É–∑–ª–∞, 2 –ø—Ä–∏–∑–Ω–∞–∫–∞
data_pyg.edge_index.shape # torch.Size([2, 3])  - 3 —Ä–µ–±—Ä–∞
```

---

## –®–∞–≥ 6: –û–±—É—á–µ–Ω–∏–µ DAGNN –º–æ–¥–µ–ª–∏

### 6.1 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              DAGNNRecommender Model                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Input: x (num_nodes, 2)  +  edge_index (2, num_edges)
  ‚îÇ
  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Layer 1: Linear(2 ‚Üí 64)                 ‚îÇ
‚îÇ          + BatchNorm                    ‚îÇ
‚îÇ          + ReLU                         ‚îÇ
‚îÇ          + Dropout(0.4)                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ (num_nodes, 64)
                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Layer 2: Linear(64 ‚Üí 64)                ‚îÇ
‚îÇ          + BatchNorm                    ‚îÇ
‚îÇ          + ReLU                         ‚îÇ
‚îÇ          + Residual Connection          ‚îÇ
‚îÇ          + Dropout(0.4)                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ (num_nodes, 64)
                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Layer 3: DAGNN(64, K=10)                ‚îÇ
‚îÇ          Graph Propagation              ‚îÇ
‚îÇ          + Attention Weights            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ (num_nodes, 64)
                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Layer 4: Linear(64 ‚Üí 32)                ‚îÇ
‚îÇ          + BatchNorm                    ‚îÇ
‚îÇ          + ReLU                         ‚îÇ
‚îÇ          + Dropout(0.4)                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ (num_nodes, 32)
                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Layer 5: Linear(32 ‚Üí num_nodes)         ‚îÇ
‚îÇ          Output layer                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ (num_nodes, num_nodes)
                ‚ñº
Output: Predictions for each node
```

### 6.2 –î–µ—Ç–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–ª–æ–∏

**–ü—Ä–∏–º–µ—Ä:** 4 —É–∑–ª–∞, 2 –ø—Ä–∏–∑–Ω–∞–∫–∞

#### –í—Ö–æ–¥:
```
x: tensor([[1, 0],    # service_123
           [0, 1],    # table_1001
           [1, 0],    # service_456
           [0, 1]])   # table_1002
Shape: (4, 2)
```

#### Layer 1: Linear(2 ‚Üí 64)
```python
self.lin1 = nn.Linear(2, 64)

# –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞:
out = x @ W^T + b
# –≥–¥–µ W: (64, 2), b: (64,)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
x = self.lin1(x)  # (4, 2) ‚Üí (4, 64)
x = self.bn1(x)   # BatchNorm –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –ø–æ –±–∞—Ç—á—É
x = F.relu(x)     # ReLU: max(0, x)
x = F.dropout(x, 0.4)  # –°–ª—É—á–∞–π–Ω–æ –∑–∞–Ω—É–ª—è–µ—Ç 40% –Ω–µ–π—Ä–æ–Ω–æ–≤

–ü–æ—Å–ª–µ Layer 1:
tensor([[0.23, 0.45, 0.0, 0.89, ...],   # service_123 (64 –∑–Ω–∞—á–µ–Ω–∏—è)
        [0.12, 0.0, 0.56, 0.34, ...],   # table_1001
        [0.67, 0.23, 0.12, 0.0, ...],   # service_456
        [0.0, 0.78, 0.23, 0.45, ...]])  # table_1002
Shape: (4, 64)
```

#### Layer 2: Linear(64 ‚Üí 64) + Residual
```python
identity = x  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è residual connection

x = self.lin2(x)      # (4, 64) ‚Üí (4, 64)
x = self.bn2(x)       # BatchNorm
x = F.relu(x)         # ReLU
x = x + identity      # Residual: –¥–æ–±–∞–≤–ª—è–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π x
x = F.dropout(x, 0.4)

Residual Connection (–ø–æ—á–µ–º—É –≤–∞–∂–Ω–æ):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   x    ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
    ‚îÇ                ‚îÇ
    ‚ñº                ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
‚îÇ Linear ‚îÇ           ‚îÇ
‚îÇ  + BN  ‚îÇ           ‚îÇ
‚îÇ + ReLU ‚îÇ           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
    ‚îÇ                ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ + ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         (element-wise add)
    
–ü–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å vanishing gradient
```

#### Layer 3: DAGNN (Graph Propagation)

```python
self.dagnn = DAGNN(64, K=10, dropout=0.4)

# DAGNN - —ç—Ç–æ APPNP (Approximate Personalized Propagation of Neural Predictions)
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç DAGNN:**

```
–ò—Ç–µ—Ä–∞—Ü–∏—è 0: x‚ÇÄ = x (–Ω–∞—á–∞–ª—å–Ω—ã–µ features)

–ò—Ç–µ—Ä–∞—Ü–∏—è 1: x‚ÇÅ = propagate(x‚ÇÄ, edge_index)
  –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞: x‚ÇÅ[i] = Œ£(x‚ÇÄ[neighbors] * weights)
  
–ò—Ç–µ—Ä–∞—Ü–∏—è 2: x‚ÇÇ = propagate(x‚ÇÅ, edge_index)
  ...
  
–ò—Ç–µ—Ä–∞—Ü–∏—è K: x_K = propagate(x_{K-1}, edge_index)

–§–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥:
  out = attention_weights[0] * x‚ÇÄ + 
        attention_weights[1] * x‚ÇÅ + 
        ... + 
        attention_weights[K] * x_K
```

**–í–∏–∑—É–∞–ª—å–Ω–æ (K=2):**

```
–ì—Ä–∞—Ñ:
  0 ‚Üí 1 ‚Üí 2 ‚Üí 3

–ò—Ç–µ—Ä–∞—Ü–∏—è 0 (–∏—Å—Ö–æ–¥–Ω—ã–µ features):
  node_0: [0.5, 0.3, ...]
  node_1: [0.2, 0.7, ...]
  node_2: [0.8, 0.1, ...]
  node_3: [0.4, 0.6, ...]

–ò—Ç–µ—Ä–∞—Ü–∏—è 1 (–ø–µ—Ä–≤–∞—è propagation):
  node_0: [0.5, 0.3, ...] (–Ω–µ—Ç –≤—Ö–æ–¥—è—â–∏—Ö)
  node_1: avg([0.5, 0.3, ...]) = [0.5, 0.3, ...]  –æ—Ç node_0
  node_2: avg([0.2, 0.7, ...]) = [0.2, 0.7, ...]  –æ—Ç node_1
  node_3: avg([0.8, 0.1, ...]) = [0.8, 0.1, ...]  –æ—Ç node_2

–ò—Ç–µ—Ä–∞—Ü–∏—è 2 (–≤—Ç–æ—Ä–∞—è propagation):
  node_0: [0.5, 0.3, ...]
  node_1: avg([0.5, 0.3, ...])
  node_2: avg([0.5, 0.3, ...])  ‚Üê –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç node_0 –¥–æ—à–ª–∞!
  node_3: avg([0.2, 0.7, ...])  ‚Üê –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç node_1 –¥–æ—à–ª–∞!

–§–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥ (–≤–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞):
  out = 0.3 * x‚ÇÄ + 0.5 * x‚ÇÅ + 0.2 * x‚ÇÇ
  (attention_weights –æ–±—É—á–∞—é—Ç—Å—è!)
```

**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ:**
- –£–∑–ª—ã "—É–∑–Ω–∞—é—Ç" –æ —Å–æ—Å–µ–¥—è—Ö
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ –≥—Ä–∞—Ñ—É
- –î–∞–ª—å–Ω–∏–µ —É–∑–ª—ã –≤–ª–∏—è—é—Ç –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞

#### Layer 4: Linear(64 ‚Üí 32)
```python
x = self.lin3(x)      # (4, 64) ‚Üí (4, 32)
x = self.bn3(x)       # BatchNorm
x = F.relu(x)         # ReLU
x = F.dropout(x, 0.4)

–£–º–µ–Ω—å—à–∞–µ–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
```

#### Layer 5: Output Linear(32 ‚Üí num_nodes)
```python
x = self.lin_out(x)   # (4, 32) ‚Üí (4, 4)

# –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞ –ø–æ–ª—É—á–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –≤–æ –≤—Å–µ —É–∑–ª—ã

Output (logits):
tensor([[-0.5,  2.1, -1.3,  0.8],   # service_123: –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ ‚Üí [table_1001, service_456, ...]
        [ 1.2, -0.3,  3.5, -0.8],   # table_1001: ...
        [-0.9,  0.7, -1.1,  2.9],   # service_456: ...
        [ 0.3, -1.5,  1.8, -0.4]])  # table_1002: ...

Shape: (4, 4)  # –ö–∞–∂–¥—ã–π —É–∑–µ–ª ‚Üí –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞
```

### 5.6 –ü–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ –ø—Ä—è–º–æ–≥–æ –ø—Ä–æ—Ö–æ–¥–∞

```
Input:
  x: (4, 2)
  edge_index: (2, 3)
  
     ‚Üì Linear(2‚Üí64) + BN + ReLU + Dropout
     
  (4, 64)
  
     ‚Üì Linear(64‚Üí64) + BN + ReLU + Residual + Dropout
     
  (4, 64)
  
     ‚Üì DAGNN(K=10) - Graph Propagation
     
  (4, 64)
  
     ‚Üì Linear(64‚Üí32) + BN + ReLU + Dropout
     
  (4, 32)
  
     ‚Üì Linear(32‚Üí4)
     
  (4, 4) ‚Üê Output logits

     ‚Üì Softmax (–ø—Ä–∏ inference)
     
  (4, 4) ‚Üê Probabilities
```

---

## –®–∞–≥ 6.3: –ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è

### 6.3.1 Loss Calculation

```python
# Forward pass
out = model(data_pyg.x, data_pyg.edge_index, training=True)
# out shape: (num_nodes, num_nodes)

# –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —É–∑–ª—ã (–∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤)
out_selected = out[contexts]
# –ï—Å–ª–∏ contexts = [0, 1], —Ç–æ out_selected = [out[0], out[1]]

# –í—ã—á–∏—Å–ª—è–µ–º Cross Entropy Loss
loss = F.cross_entropy(out_selected, targets)
```

**–í–∏–∑—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞:**

```
out (–≤—Å–µ —É–∑–ª—ã):
  [[logit_0_0, logit_0_1, logit_0_2, logit_0_3],   ‚Üê node_0
   [logit_1_0, logit_1_1, logit_1_2, logit_1_3],   ‚Üê node_1
   [logit_2_0, logit_2_1, logit_2_2, logit_2_3],   ‚Üê node_2
   [logit_3_0, logit_3_1, logit_3_2, logit_3_3]]   ‚Üê node_3

contexts = [1, 0]  # –ò–Ω–¥–µ–∫—Å—ã —É–∑–ª–æ–≤ –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º

out[contexts]:
  [[logit_1_0, logit_1_1, logit_1_2, logit_1_3],   ‚Üê node_1 (table_1001)
   [logit_0_0, logit_0_1, logit_0_2, logit_0_3]]   ‚Üê node_0 (service_123)

targets = [0, 2]  # –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã: service_123 –∏ service_456

Cross Entropy:
  loss = -log(softmax(out[1])[0]) +    # table_1001 ‚Üí service_123
         -log(softmax(out[0])[2])      # service_123 ‚Üí service_456
  
  –¶–µ–ª—å: –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å loss
  ‚Üí –ú–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –¥–∞–≤–∞—Ç—å –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
```

### 6.3.2 Backward Pass & Optimization

```python
# 1. –û–±–Ω—É–ª–∏—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
optimizer.zero_grad()

# 2. Forward pass
out = model(data_pyg.x, data_pyg.edge_index, training=True)
loss = F.cross_entropy(out[contexts], targets)

# 3. Backward pass (–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤)
loss.backward()
# –í—ã—á–∏—Å–ª—è–µ—Ç ‚àÇloss/‚àÇW –¥–ª—è –≤—Å–µ—Ö –≤–µ—Å–æ–≤ W

# 4. Gradient clipping (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç exploding gradients)
torch.nn.utils.clip_grad_norm_(model.parameters(), max_norm=1.0)

# 5. Update weights
optimizer.step()
# W_new = W_old - learning_rate * gradient
```

**–ü—Ä–∏–º–µ—Ä –æ–±—É—á–µ–Ω–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**

```
–û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞:
  table_1001 ‚Üí service_123  (—Ç–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —Å–µ—Ä–≤–∏—Å—É)
  service_123 ‚Üí service_456 (—Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–µ—Ä–≤–∏—Å–∞ –∏–¥—ë—Ç –¥–∞–ª—å—à–µ)
  table_1002 ‚Üí service_456  (–≤—Ç–æ—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞)

contexts = [1, 0, 3]  # –ò–Ω–¥–µ–∫—Å—ã: table_1001, service_123, table_1002
targets  = [0, 2, 2]  # –ò–Ω–¥–µ–∫—Å—ã: service_123, service_456, service_456

–ú–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è:
  "–ü–æ—Å–ª–µ table_1001 –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç service_123"
  "–ü–æ—Å–ª–µ service_123 –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç service_456"
  "–ü–æ—Å–ª–µ table_1002 –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç service_456"
```

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è:**

```
Epoch 1:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Forward  ‚Üí Loss: 2.35                  ‚îÇ
‚îÇ Backward ‚Üí Gradients computed          ‚îÇ
‚îÇ Update   ‚Üí Weights updated             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº Weights improved
         
Epoch 2:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Forward  ‚Üí Loss: 1.89  ‚úì (lower!)     ‚îÇ
‚îÇ Backward ‚Üí Gradients computed          ‚îÇ
‚îÇ Update   ‚Üí Weights updated             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº Weights improved more
         
...

Epoch 200:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Forward  ‚Üí Loss: 0.15  ‚úì‚úì‚úì (converged)‚îÇ
‚îÇ EARLY STOPPING (no improvement)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 6.3.3 –î–µ—Ç–∞–ª–∏ –æ–±—É—á–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è

**Layer 1 (Linear + BN):**
```
–û–±—É—á–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
  W1: (64, 2)    - –≤–µ—Å–∞ linear —Å–ª–æ—è
  b1: (64,)      - bias linear —Å–ª–æ—è
  Œ≥1: (64,)      - scale BatchNorm
  Œ≤1: (64,)      - shift BatchNorm

–ò—Ç–æ–≥–æ: 64*2 + 64 + 64 + 64 = 320 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ß—Ç–æ —É—á–∏—Ç—Å—è:
  - –ö–∞–∫–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ [is_service, is_table] –≤–∞–∂–Ω—ã
  - –ö–∞–∫ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å 2D –≤ 64D –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
```

**Layer 2 (Linear + Residual):**
```
–û–±—É—á–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
  W2: (64, 64)   - –≤–µ—Å–∞
  b2: (64,)      - bias
  Œ≥2: (64,)      - BatchNorm scale
  Œ≤2: (64,)      - BatchNorm shift

–ò—Ç–æ–≥–æ: 64*64 + 64 + 64 + 64 = 4288 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ß—Ç–æ —É—á–∏—Ç—Å—è:
  - –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ 64D –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ
  - Residual –ø–æ–º–æ–≥–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ Layer 1
```

**Layer 3 (DAGNN - Graph Propagation):**
```
–û–±—É—á–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
  attention_weights: (K+1,)  –≥–¥–µ K=10
  
–ò—Ç–æ–≥–æ: 11 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ß—Ç–æ —É—á–∏—Ç—Å—è:
  - –°–∫–æ–ª—å–∫–æ –≤–Ω–∏–º–∞–Ω–∏—è —É–¥–µ–ª—è—Ç—å –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ propagation
  - att[0]: –≤–µ—Å –∏—Å—Ö–æ–¥–Ω—ã—Ö features
  - att[1]: –≤–µ—Å –ø–æ—Å–ª–µ 1 hop
  - att[2]: –≤–µ—Å –ø–æ—Å–ª–µ 2 hops
  - ...
  - att[10]: –≤–µ—Å –ø–æ—Å–ª–µ 10 hops
  
Softmax(att) –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å—É–º–º–∞ = 1
```

**DAGNN Propagation –¥–µ—Ç–∞–ª—å–Ω–æ:**

```
K = 10 –∏—Ç–µ—Ä–∞—Ü–∏–π

–ò—Ç–µ—Ä–∞—Ü–∏—è 0: x‚ÇÄ = current_features

–ò—Ç–µ—Ä–∞—Ü–∏—è 1:
  for each node i:
    x‚ÇÅ[i] = Œ£(x‚ÇÄ[neighbor_j] * edge_weight[j‚Üíi]) / degree[i]
    
  –ü—Ä–∏–º–µ—Ä –¥–ª—è node_1 (table_1001):
    neighbors = [node_0]  # service_123
    x‚ÇÅ[1] = x‚ÇÄ[0] * 1.0 / 1 = x‚ÇÄ[0]
    
  –î–ª—è node_2 (service_456):
    neighbors = [node_1]
    x‚ÇÅ[2] = x‚ÇÄ[1]

–ò—Ç–µ—Ä–∞—Ü–∏—è 2:
  node_2 —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç node_0 (—á–µ—Ä–µ–∑ node_1)
  x‚ÇÇ[2] = aggregate(x‚ÇÅ[1]) = aggregate(x‚ÇÄ[0])
  
... –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è K —Ä–∞–∑

–§–∏–Ω–∞–ª:
  out = att[0]*x‚ÇÄ + att[1]*x‚ÇÅ + ... + att[10]*x‚ÇÅ‚ÇÄ
  
–ö–∞–∂–¥—ã–π —É–∑–µ–ª "–≤–∏–¥–∏—Ç" –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –¥–æ K hops!
```

**Layer 4 (Dimension Reduction):**
```
–û–±—É—á–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
  W4: (32, 64)
  b4: (32,)
  Œ≥4, Œ≤4: BatchNorm

–ò—Ç–æ–≥–æ: 32*64 + 32 + 32 + 32 = 2144 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ß—Ç–æ —É—á–∏—Ç—Å—è:
  - –°–∂–∞—Ç–∏–µ 64D ‚Üí 32D (—É–±–∏—Ä–∞–µ—Ç —à—É–º)
  - –í—ã–¥–µ–ª—è–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
```

**Layer 5 (Output):**
```
–û–±—É—á–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
  W_out: (num_nodes, 32)  # –í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ (4, 32)
  b_out: (num_nodes,)     # (4,)

–ò—Ç–æ–≥–æ: 4*32 + 4 = 132 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ß—Ç–æ —É—á–∏—Ç—Å—è:
  - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ —Ü–µ–ª–µ–≤–æ–≥–æ —É–∑–ª–∞
  - –ö–∞–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ 32D –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —ç—Ç–æ—Ç —É–∑–µ–ª
```

### 6.3.4 –ò—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏

```
Layer 1:      320 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
Layer 2:    4,288 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
DAGNN:         11 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
Layer 4:    2,144 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
Layer 5:      132 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ò–¢–û–ì–û:     6,895 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–í—Å–µ –æ–Ω–∏ –æ–±—É—á–∞—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ backpropagation!
```

### 6.3.5 –ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è (200 —ç–ø–æ—Ö)

```
Epoch 1:
  Loss: 2.347
  Gradient: Large (–º–æ–¥–µ–ª—å –¥–∞–ª–µ–∫–∞ –æ—Ç –æ–ø—Ç–∏–º—É–º–∞)
  Learning rate: 0.001
  Weight update: –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π
  
Epoch 10:
  Loss: 1.523  ‚úì
  Gradient: Medium
  Learning rate: 0.001 (–Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è)
  
Epoch 50:
  Loss: 0.823  ‚úì‚úì
  Gradient: Small
  Learning rate: 0.0005  ‚Üê ReduceLROnPlateau —Å–Ω–∏–∑–∏–ª
  
Epoch 100:
  Loss: 0.234  ‚úì‚úì‚úì
  Gradient: Very small
  Learning rate: 0.00025
  
Epoch 150:
  Loss: 0.152
  No improvement for 50 epochs
  ‚Üí EARLY STOPPING

–ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞!
```

---

## –®–∞–≥ 7: Inference (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ)

### 7.1 –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è

```
–î–∞–Ω–æ: sequence = [table_1001, service_123]
–¶–µ–ª—å: –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —É–∑–µ–ª

–®–∞–≥ 1: –í–∑—è—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —É–∑–µ–ª
  last_node = 'service_123'
  last_idx = node_map['service_123'] = 0

–®–∞–≥ 2: Forward pass —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å
  model.eval()  # –û—Ç–∫–ª—é—á–∏—Ç—å dropout
  with torch.no_grad():  # –ù–µ –≤—ã—á–∏—Å–ª—è—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
      out = model(data_pyg.x, data_pyg.edge_index, training=False)
  
  out shape: (4, 4)
  out = [
    [logit_0_to_0, logit_0_to_1, logit_0_to_2, logit_0_to_3],
    [logit_1_to_0, logit_1_to_1, logit_1_to_2, logit_1_to_3],  ‚Üê –Ω–∞–º –Ω—É–∂–Ω–∞ —ç—Ç–∞ —Å—Ç—Ä–æ–∫–∞!
    [logit_2_to_0, logit_2_to_1, logit_2_to_2, logit_2_to_3],
    [logit_3_to_0, logit_3_to_1, logit_3_to_2, logit_3_to_3]
  ]

–®–∞–≥ 3: –í–∑—è—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É–∑–ª–∞
  node_scores = out[1]  # –°—Ç—Ä–æ–∫–∞ –¥–ª—è table_1001
  # tensor([-0.5, 0.3, 2.8, 0.9])

–®–∞–≥ 4: –ü—Ä–∏–º–µ–Ω–∏—Ç—å Softmax
  probs = F.softmax(node_scores, dim=0)
  # tensor([0.05, 0.11, 0.72, 0.12])
  #         ‚Üë     ‚Üë     ‚Üë     ‚Üë
  #      node_0 node_1 node_2 node_3

–®–∞–≥ 5: –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
  top_indices = np.argsort(probs)[::-1]
  # [2, 3, 1, 0]  ‚Üê node_2 (service_456) –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–µ–Ω!

–®–∞–≥ 6: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ –≤ –∏–º–µ–Ω–∞
  predictions = [
    reverse_node_map[2],  # service_456
    reverse_node_map[3],  # table_1002
    ...
  ]
```

### 7.2 –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä

```
DAG (–ü–†–ê–í–ò–õ–¨–ù–´–ï –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è):
  table_1001  ‚Üí service_123
  table_1002  ‚Üí service_456
  service_123 ‚Üí service_456
  service_456 ‚Üí service_789

–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: [table_1001, service_123]
–ü–æ—Å–ª–µ–¥–Ω–∏–π —É–∑–µ–ª: service_123 (–∏–Ω–¥–µ–∫—Å 0)

Forward pass:
  out[0] = [
     0.3,   # service_123 ‚Üí service_123 (unlikely, –ø–µ—Ç–ª—è)
    -0.5,   # service_123 ‚Üí table_1001  (IMPOSSIBLE! table –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ü–µ–ª—å—é)
     2.8,   # service_123 ‚Üí service_456 (LIKELY! ‚úì)
     0.9,   # service_123 ‚Üí service_789 (possible, –Ω–æ –º–µ–Ω–µ–µ –≤–µ—Ä–æ—è—Ç–Ω–æ)
     ...
  ]

Softmax:
  probs = [0.11, 0.05, 0.72, 0.12, ...]
                         ‚Üë
                   service_456 (72% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)

Top-5 predictions (—Ñ–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å—ã):
  1. service_456  (0.72) ‚Üê –ú–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∞!
  2. service_789  (0.12)
  3. service_123  (0.11) (–ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
  4. ...
  
Note: table_1001 –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è –∏–∑ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π 
      (—Ç–∞–±–ª–∏—Ü—ã –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Ü–µ–ª—å—é, —Ç–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º!)
```

---

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Table-based —Ä–µ–∂–∏–º–∞

### –û—Ç–ª–∏—á–∏—è –æ—Ç Service-based

```
Service-based:                    Table-based:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Sequence:            ‚îÇ         ‚îÇ Sequence:            ‚îÇ
‚îÇ [s_123, s_456, s_789]‚îÇ         ‚îÇ [t_1001, t_1002]     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                                ‚îÇ
         ‚ñº                                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å:         ‚îÇ         ‚îÇ –ù–∞–π—Ç–∏ –¥–æ—Å—Ç–∏–∂–∏–º—ã–µ:    ‚îÇ
‚îÇ service_999          ‚îÇ         ‚îÇ –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑       ‚îÇ
‚îÇ                      ‚îÇ         ‚îÇ t_1002 —á–µ—Ä–µ–∑ –ª—é–±—ã–µ   ‚îÇ
‚îÇ –£—á–∏—Ç—ã–≤–∞–µ—Ç:           ‚îÇ         ‚îÇ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ        ‚îÇ
‚îÇ - –¢–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å—ã     ‚îÇ         ‚îÇ —Å–µ—Ä–≤–∏—Å—ã              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ü—Ä–∏–º–µ—Ä (–ü–†–ê–í–ò–õ–¨–ù–ê–Ø —Å—Ö–µ–º–∞):
t_1001 ‚Üí s_123 ‚Üí s_456
t_1002 ‚Üí s_456 ‚Üí s_789

s_789 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç/—Å–æ–∑–¥–∞—ë—Ç ‚Üí t_1003

Service sequence: [s_123, s_456]
  ‚Üí Predict: s_789

Table sequence: [t_1001, t_1002]
  ‚Üí –ê–Ω–∞–ª–∏–∑:
    1. t_1002 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ s_456
    2. –ü–æ—Å–ª–µ s_456 –∏–¥—ë—Ç s_789
    3. s_789 —Å–≤—è–∑–∞–Ω —Å t_1003
  ‚Üí –ù–∞–π—Ç–∏: t_1003
  ‚Üí Distance: 1 (–æ—Ç t_1002 –¥–æ t_1003 - –æ–¥–∏–Ω table hop)
```

### –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –¥–æ—Å—Ç–∏–∂–∏–º—ã—Ö —Ç–∞–±–ª–∏—Ü

```python
def _find_reachable_tables(start_table):
    """BFS –ø–æ –≥—Ä–∞—Ñ—É, —Å–æ–±–∏—Ä–∞—è —Ç–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü—ã"""
    
    reachable = set()
    visited = set()
    queue = [start_table]
    
    while queue:
        current = queue.pop(0)
        visited.add(current)
        
        # –°–º–æ—Ç—Ä–∏–º –≤—Å–µ—Ö –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–æ–≤
        for successor in dag.successors(current):
            # –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ - –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            if successor.startswith("table_"):
                reachable.add(successor)
            
            # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å—ã —Ç–æ–∂–µ
            if successor not in visited:
                queue.append(successor)
    
    return reachable
```

**–í–∏–∑—É–∞–ª—å–Ω–æ:**

```
Start: table_1001

–†–µ–∞–ª—å–Ω—ã–π DAG:
  table_1001 ‚Üí service_123
  service_123 ‚Üí service_456
  table_1002 ‚Üí service_456
  table_1003 ‚Üí service_789
  service_456 ‚Üí service_789

–ò—Ç–µ—Ä–∞—Ü–∏—è 1:
  current = table_1001
  successors = [service_123]  # –¢–∞–±–ª–∏—Ü–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ service_123
  reachable = []              # service_123 –Ω–µ —Ç–∞–±–ª–∏—Ü–∞, –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º
  queue = [service_123]

–ò—Ç–µ—Ä–∞—Ü–∏—è 2:
  current = service_123
  successors = [service_456]  # –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–¥—ë—Ç –≤ service_456
  reachable = []
  queue = [service_456]

–ò—Ç–µ—Ä–∞—Ü–∏—è 3:
  current = service_456
  successors = [service_789]
  reachable = []
  queue = [service_789]

–ò—Ç–µ—Ä–∞—Ü–∏—è 4:
  current = service_789
  successors = []  # –ö–æ–Ω–µ—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å
  
  –ù–û! –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –≤ –≥—Ä–∞—Ñ–µ:
    table_1002 ‚Üí service_456 (service_456 —É–∂–µ –ø–æ—Å–µ—â—ë–Ω)
    table_1003 ‚Üí service_789 (service_789 —É–∂–µ –ø–æ—Å–µ—â—ë–Ω)
  
  reachable = [table_1002, table_1003]  ‚Üê –¢–∞–±–ª–∏—Ü—ã –¥–ª—è –ø–æ—Å–µ—â—ë–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤!

–†–µ–∑—É–ª—å—Ç–∞—Ç: [table_1002, table_1003]

–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:
  –û—Ç table_1001 –º—ã –ø—Ä–æ—à–ª–∏ —á–µ—Ä–µ–∑ service_123 ‚Üí service_456 ‚Üí service_789
  –≠—Ç–∏ —Å–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç/—Å–≤—è–∑–∞–Ω—ã —Å table_1002 –∏ table_1003
  –ó–Ω–∞—á–∏—Ç table_1002 –∏ table_1003 - –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã!
```

---

## –ü–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    SEQUENTIAL RECOMMENDATION                 ‚îÇ
‚îÇ                         FULL PIPELINE                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

1Ô∏è‚É£ –°–ë–û–† –î–ê–ù–ù–´–•
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ  PostgreSQL  ‚îÇ
   ‚îÇ    Calls     ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚ñº
   recover_new(db)
          ‚îÇ
          ‚ñº
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇcompositionsDAG.  ‚îÇ
   ‚îÇ     json         ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

2Ô∏è‚É£ –ü–û–°–¢–†–û–ï–ù–ò–ï –ì–†–ê–§–ê
          ‚îÇ
          ‚ñº
   _load_dag_from_json()
          ‚îÇ
          ‚ñº
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ  NetworkX DiGraph‚îÇ
   ‚îÇ  - nodes: 1247   ‚îÇ
   ‚îÇ  - edges: 3421   ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

3Ô∏è‚É£ –°–û–ó–î–ê–ù–ò–ï –û–ë–£–ß–ê–Æ–©–ò–• –î–ê–ù–ù–´–•
          ‚îÇ
          ‚ñº
   _extract_paths()
          ‚îÇ
          ‚ñº
   Paths: [[A,B,C], [D,E,F], ...]
          ‚îÇ
          ‚ñº
   _create_training_data()
          ‚îÇ
          ‚ñº
   X_raw: [(A,), (A,B), ...]
   y_raw: [C, D, ...]

4Ô∏è‚É£ –ö–û–î–ò–†–û–í–ê–ù–ò–ï
          ‚îÇ
          ‚ñº
   LabelEncoder.fit_transform()
          ‚îÇ
          ‚ñº
   node_map: {node_name: index}
          ‚îÇ
          ‚ñº
   contexts: tensor([0, 5, 12, ...])
   targets:  tensor([3, 8, 15, ...])

5Ô∏è‚É£ –°–û–ó–î–ê–ù–ò–ï PYTORCH GEOMETRIC DATA
          ‚îÇ
          ‚ñº
   Data(
     x = [[1,0], [0,1], ...],        # Node features
     edge_index = [[0,1,...],        # Graph structure
                   [1,2,...]]
   )

6Ô∏è‚É£ –û–ë–£–ß–ï–ù–ò–ï
          ‚îÇ
          ‚ñº
   for epoch in range(200):
     ‚îú‚îÄ Forward pass
     ‚îú‚îÄ Calculate loss
     ‚îú‚îÄ Backward pass
     ‚îú‚îÄ Update weights
     ‚îî‚îÄ Check early stopping

7Ô∏è‚É£ –°–û–•–†–ê–ù–ï–ù–ò–ï
          ‚îÇ
          ‚ñº
   Save:
   - dagnn_model.pth      (–≤–µ—Å–∞ –º–æ–¥–µ–ª–∏)
   - dagnn_metadata.pkl   (node_map, DAG)

8Ô∏è‚É£ INFERENCE
          ‚îÇ
          ‚ñº
   Input: sequence = [123, 456]
          ‚îÇ
          ‚ñº
   last_node_idx = node_map['service_456']
          ‚îÇ
          ‚ñº
   out = model(x, edge_index)
   probs = softmax(out[last_node_idx])
          ‚îÇ
          ‚ñº
   top_predictions = argsort(probs)[:n]
          ‚îÇ
          ‚ñº
   Output: [service_789, service_321, ...]
```

---

## –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–æ—Ä–º—É–ª—ã

### Forward Pass

```
Input: x ‚àà ‚Ñù^(N√ó2), edge_index ‚àà ‚Ñ§^(2√óE)
–≥–¥–µ N = —á–∏—Å–ª–æ —É–∑–ª–æ–≤, E = —á–∏—Å–ª–æ —Ä—ë–±–µ—Ä

Layer 1:
  h‚ÇÅ = ReLU(BN(xW‚ÇÅ·µÄ + b‚ÇÅ))
  h‚ÇÅ ‚àà ‚Ñù^(N√ó64)

Layer 2 (—Å residual):
  h‚ÇÇ = ReLU(BN(h‚ÇÅW‚ÇÇ·µÄ + b‚ÇÇ)) + h‚ÇÅ
  h‚ÇÇ ‚àà ‚Ñù^(N√ó64)

DAGNN Propagation:
  h‚ÇÄ = h‚ÇÇ
  
  for k = 1 to K:
    h‚Çñ = D‚Åª¬πAh‚Çñ‚Çã‚ÇÅ
    –≥–¥–µ A - adjacency matrix, D - degree matrix
  
  h_out = Œ£‚Çñ Œ±‚Çñh‚Çñ
  –≥–¥–µ Œ± = softmax(att_weights)

Layer 4:
  h‚ÇÑ = ReLU(BN(h_outW‚ÇÑ·µÄ + b‚ÇÑ))
  h‚ÇÑ ‚àà ‚Ñù^(N√ó32)

Layer 5 (output):
  ≈∑ = h‚ÇÑW_out·µÄ + b_out
  ≈∑ ‚àà ‚Ñù^(N√óN)

Loss:
  L = -Œ£·µ¢ log(softmax(≈∑·µ¢)[y·µ¢])
  –≥–¥–µ i –ø—Ä–æ–±–µ–≥–∞–µ—Ç –ø–æ training samples
```

### Backpropagation

```
–ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –æ—Ç output –∫ input:

‚àÇL/‚àÇW_out ‚Üê –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º
   ‚Üì
‚àÇL/‚àÇW‚ÇÑ
   ‚Üì
‚àÇL/‚àÇatt_weights (DAGNN)
   ‚Üì
‚àÇL/‚àÇW‚ÇÇ
   ‚Üì
‚àÇL/‚àÇW‚ÇÅ ‚Üê –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤:
  W_new = W_old - lr * ‚àÇL/‚àÇW

–≥–¥–µ lr = learning_rate (0.001 ‚Üí 0.0005 ‚Üí 0.00025)
```

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: Services vs Tables —Ä–µ–∂–∏–º—ã

### Services Mode

```
Input: [service_123, service_456]

Algorithm:
  1. last_service = service_456
  2. model.predict(service_456)
  3. Filter: only service_* nodes
  4. Return: [service_789, service_321, ...]
  
Output: –°–ª–µ–¥—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã
```

### Tables Mode

```
Input: [table_1001, table_1002]

Algorithm:
  1. last_table = table_1002
  2. reachable = find_reachable_tables(table_1002)
     ‚Üí [table_1003, table_1004, ...] (—á–µ—Ä–µ–∑ BFS)
  3. For each reachable_table:
       a. model.predict(last_table) ‚Üí model_score
       b. calculate_distance(last_table, reachable_table) ‚Üí distance
       c. get_frequency(reachable_table) ‚Üí frequency
       d. combined_score = 0.5*model + 0.3*distance + 0.2*freq
  4. Sort by combined_score
  5. Return top N
  
Output: –°–ª–µ–¥—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å —É—á—ë—Ç–æ–º:
  - ML prediction
  - –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ DAG
  - –ß–∞—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ —Ç—Ä—é–∫–∏

### 1. Batch Normalization
```
–ó–∞—á–µ–º: –°—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç –æ–±—É—á–µ–Ω–∏–µ
–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
  - –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –≤—Ö–æ–¥—ã: (x - mean) / std
  - –û–±—É—á–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Œ≥, Œ≤ –¥–ª—è scaling/shifting
  - –ü–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å internal covariate shift
```

### 2. Dropout
```
–ó–∞—á–µ–º: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç overfitting
–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
  - Training: –°–ª—É—á–∞–π–Ω–æ –∑–∞–Ω—É–ª—è–µ—Ç 40% –Ω–µ–π—Ä–æ–Ω–æ–≤
  - Inference: –í—Å–µ –Ω–µ–π—Ä–æ–Ω—ã –∞–∫—Ç–∏–≤–Ω—ã, –≤—ã—Ö–æ–¥—ã * (1-p)
  - –ó–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Å–µ—Ç—å —É—á–∏—Ç—å robust–Ω—ã–µ features
```

### 3. Residual Connection
```
–ó–∞—á–µ–º: –ü–æ–º–æ–≥–∞–µ—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º "—Ç–µ—á—å" –Ω–∞–∑–∞–¥
–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
  out = F(x) + x
  - –ï—Å–ª–∏ F(x) —É—á–∏—Ç—Å—è –ø–ª–æ—Ö–æ, –≥—Ä–∞–¥–∏–µ–Ω—Ç –≤—Å—ë —Ä–∞–≤–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ x
  - –ü–æ–º–æ–≥–∞–µ—Ç –æ–±—É—á–∞—Ç—å –≥–ª—É–±–æ–∫–∏–µ —Å–µ—Ç–∏
```

### 4. Gradient Clipping
```
–ó–∞—á–µ–º: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç exploding gradients
–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
  if ||gradient|| > max_norm:
      gradient = gradient * max_norm / ||gradient||
  - –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –Ω–æ—Ä–º—É –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
  - max_norm = 1.0 –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ
```

### 5. Early Stopping
```
–ó–∞—á–µ–º: –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –∫–æ–≥–¥–∞ –Ω–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π
–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
  if loss < best_loss:
      best_loss = loss
      patience_counter = 0
  else:
      patience_counter += 1
      if patience_counter >= 50:
          STOP  # 50 —ç–ø–æ—Ö –±–µ–∑ —É–ª—É—á—à–µ–Ω–∏—è
```

### 6. Learning Rate Scheduling
```
–ó–∞—á–µ–º: –ê–¥–∞–ø—Ç–∏–≤–Ω–æ —É–º–µ–Ω—å—à–∞–µ—Ç learning rate
–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
  ReduceLROnPlateau:
    if loss –Ω–µ —É–ª—É—á—à–∞–µ—Ç—Å—è 20 —ç–ø–æ—Ö:
        lr = lr * 0.5
    
  0.001 ‚Üí 0.0005 ‚Üí 0.00025 ‚Üí ...
  
  –ü–æ–º–æ–≥–∞–µ—Ç fine-tune –≤ –∫–æ–Ω—Ü–µ –æ–±—É—á–µ–Ω–∏—è
```

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```
–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
  - Compositions: ~500-1000
  - Nodes: ~1000-2000
  - Edges: ~2000-5000
  - Training samples: ~1000-3000

–ú–æ–¥–µ–ª—å:
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: ~7000
  - –°–ª–æ–∏: 5
  - –¢–∏–ø—ã: Linear, BatchNorm, DAGNN

–û–±—É—á–µ–Ω–∏–µ:
  - –≠–ø–æ—Ö–∏: 50-200
  - –í—Ä–µ–º—è: 2-5 –º–∏–Ω—É—Ç
  - Early stopping: –æ–±—ã—á–Ω–æ ~100-150 —ç–ø–æ—Ö

Inference:
  - –í—Ä–µ–º—è: 10-50ms
  - –ü–∞–º—è—Ç—å: ~50MB (–º–æ–¥–µ–ª—å –≤ RAM)
```

---

## –°—Ö–µ–º–∞ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   DB    ‚îÇ Calls table
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ
     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇrecover_new()‚îÇ –ê–Ω–∞–ª–∏–∑ —Å–≤—è–∑–µ–π
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇcompositionsDAG.  ‚îÇ JSON file
‚îÇ     json         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  nx.DiGraph()    ‚îÇ –ì—Ä–∞—Ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      ‚îÇ
      ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      ‚îÇ                     ‚îÇ                     ‚îÇ
      ‚ñº                     ‚ñº                     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Extract  ‚îÇ        ‚îÇ Label    ‚îÇ        ‚îÇ Features ‚îÇ
‚îÇ Paths    ‚îÇ        ‚îÇ Encoding ‚îÇ        ‚îÇ Creation ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ                   ‚îÇ                    ‚îÇ
     ‚ñº                   ‚ñº                    ‚ñº
  X_raw,y_raw      node_map: {}          x: [[1,0],
                   {str‚Üíint}                  [0,1],
                                              ...]
     ‚îÇ                   ‚îÇ                    ‚îÇ
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚ñº
                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                  ‚îÇ PyG Data    ‚îÇ
                  ‚îÇ x + edges   ‚îÇ
                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚ñº
                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                  ‚îÇ   DAGNN     ‚îÇ
                  ‚îÇ  Training   ‚îÇ
                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚ñº
                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                  ‚îÇSave Model   ‚îÇ
                  ‚îÇ  .pth + .pkl‚îÇ
                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚ñº
                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                  ‚îÇ  Inference  ‚îÇ
                  ‚îÇ  Ready!     ‚îÇ
                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ Graph Neural Networks –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ workflow –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤. –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **DAG —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - –µ–¥–∏–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–∑–∏—Ü–∏–π
2. **LabelEncoder** - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —É–∑–ª–æ–≤ –≤ —á–∏—Å–ª–∞
3. **PyTorch Geometric** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –≥—Ä–∞—Ñ–∞–º–∏
4. **DAGNN** - propagation –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –≥—Ä–∞—Ñ—É
5. **Two modes** - Services –∏ Tables –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á

**–†–µ–∑—É–ª—å—Ç–∞—Ç: –¢–æ—á–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞ –≤ workflow! üéØ**

